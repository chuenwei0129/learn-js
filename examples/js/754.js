// 浮点数小数精度
// const gap = 0.0000000596046
// let ret = 0.5
// let i = 0

// while (i < 50) {
//   ret = ret + gap
//   console.log(ret)
//   i++
// }

// 0.5000000596046
// 0.5000001192092001
// 0.5000001788138001
// 0.5000002384184001
// 0.5000002980230002
// 0.5000003576276002
// 0.5000004172322002
// 0.5000004768368003
// 0.5000005364414003
// 0.5000005960460003

// 20.5
// 转换
// 10100.1
// 科学计数法
// 1.01001 * 2^4
// 1023 + 4 = 1027
// 10000000011
// 低位补零 52 位
// 0-10000000011-0100100000000000000000000000000000000000000000000000

// 2 ** 53 - 1
// 9007199254740991
// 53 个 1
// 11111111111111111111111111111111111111111111111111111
// 1.1111111111111111111111111111111111111111111111111111 * 2^52
// 1023 + 52 = 1075
// 10000110011
// 52 位 不需要补零
// 0-10000110011-11111111111111111111111111111111111111111111111111111

// 关键点 gap 变了
// 十进制数转浮点数
// 不考虑输入输出，只考虑思路
// 不考虑舍入规则
const doubleToBinary = double => {
  // 将浮点数转换为带符号的二进制
  let signBinary = double.toString(2)
  // 获取符号位
  let noSignBinary
  let sign
  if (signBinary[0].includes('-')) {
    noSignBinary = signBinary.slice(1)
    sign = '1'
  } else {
    noSignBinary = signBinary
    sign = '0'
  }
  // 获取指数位，尾数位
  let noBiasedExponent = noSignBinary.split('.')[0].length - 1
  let fraction = noSignBinary.replace('.', '').slice(1).padEnd(52, '0').slice(0, 52)
  let biasedExponentBinary = (noBiasedExponent + 127).toString(2)
  return `${sign} ${biasedExponentBinary} ${fraction}`
}

console.log(doubleToBinary(2 ** 53 - 3))
console.log(doubleToBinary(2 ** 53 - 2))
console.log(doubleToBinary(2 ** 53 - 1))
console.log(doubleToBinary(2 ** 53))
console.log(doubleToBinary(2 ** 53 + 1))
console.log(doubleToBinary(2 ** 53 + 2))
console.log(doubleToBinary(2 ** 53 + 3))
console.log(doubleToBinary(2 ** 53 + 4))
console.log(doubleToBinary(2 ** 53 + 5))
console.log(doubleToBinary(2 ** 53 + 6))

// 0 10110011 1111111111111111111111111111111111111111111111111101
// 0 10110011 1111111111111111111111111111111111111111111111111110
// 0 10110011 1111111111111111111111111111111111111111111111111111
// 0 10110100 0000000000000000000000000000000000000000000000000000
// 0 10110100 0000000000000000000000000000000000000000000000000000
// 0 10110100 0000000000000000000000000000000000000000000000000001
// 0 10110100 0000000000000000000000000000000000000000000000000010
// 0 10110100 0000000000000000000000000000000000000000000000000010
// 0 10110100 0000000000000000000000000000000000000000000000000010
// 0 10110100 0000000000000000000000000000000000000000000000000011
